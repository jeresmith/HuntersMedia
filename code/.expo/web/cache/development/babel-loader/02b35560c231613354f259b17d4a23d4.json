{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport React, { useState, userEffect, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport firebase from 'firebase/compat';\n\nrequire('firebase/firestore');\n\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { fetchUsersData } from \"../../redux/actions/index\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction Comment(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      comments = _useState2[0],\n      setComments = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      postId = _useState4[0],\n      setPostId = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      text = _useState6[0],\n      setText = _useState6[1];\n\n  useEffect(function () {\n    function matchUserToComment(comments) {\n      var _loop = function _loop(i) {\n        if (comments[i].hasOwnProperty('user')) {\n          return \"continue\";\n        }\n\n        var user = props.users.find(function (x) {\n          return x.uid === comments[i].creator;\n        });\n\n        if (user == undefined) {\n          props.fetchUsersData(comments[i].creator, false);\n        } else {\n          comments[i].user = user;\n        }\n      };\n\n      for (var i = 0; i < comments.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n\n      setComments(comments);\n    }\n\n    if (props.route.params.postId !== postId) {\n      firebase.firestore().collection('posts').doc(props.route.params.uid).collection('userPosts').doc(props.route.params.postId).collection('comments').get().then(function (snapshot) {\n        var comments = snapshot.docs.map(function (doc) {\n          var data = doc.data();\n          var id = doc.id;\n          return _objectSpread({\n            id: id\n          }, data);\n        });\n        matchUserToComment(comments);\n      });\n      setPostId(props.route.params.postId);\n    } else {\n      matchUserToComment(comments);\n    }\n  }, [props.route.params.postId, props.users]);\n\n  var onCommentSend = function onCommentSend() {\n    firebase.firestore().collection('posts').doc(props.route.params.uid).collection('userPosts').doc(props.route.params.postId).collection('comments').add({\n      creator: firebase.auth().currentUser.uid,\n      text: text\n    }).then(function () {\n      props.navigation.popToTop();\n    });\n  };\n\n  return _jsxs(View, {\n    children: [_jsx(FlatList, {\n      numColumns: 1,\n      horizontal: false,\n      data: comments,\n      renderItem: function renderItem(_ref) {\n        var item = _ref.item;\n        return _jsxs(View, {\n          children: [item.user !== undefined ? _jsx(Text, {\n            children: item.user.username\n          }) : null, _jsx(Text, {\n            children: item.text\n          })]\n        });\n      }\n    }), _jsxs(View, {\n      children: [_jsx(TextInput, {\n        placeholder: \"Comment..\",\n        onChangeText: function onChangeText(text) {\n          return setText(text);\n        }\n      }), _jsx(Button, {\n        onPress: function onPress() {\n          return onCommentSend();\n        },\n        title: \"Send\",\n        color: '#D2B48C'\n      })]\n    })]\n  });\n}\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    users: store.usersState.users\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return bindActionCreators({\n    fetchUsersData: fetchUsersData\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchProps)(Comment);","map":{"version":3,"sources":["/Users/jeremiah/CS470/HuntersMedia/code/components/main/Comment.js"],"names":["React","useState","userEffect","useEffect","firebase","require","connect","bindActionCreators","fetchUsersData","Comment","props","comments","setComments","postId","setPostId","text","setText","matchUserToComment","i","hasOwnProperty","user","users","find","x","uid","creator","undefined","length","route","params","firestore","collection","doc","get","then","snapshot","docs","map","data","id","onCommentSend","add","auth","currentUser","navigation","popToTop","item","username","mapStateToProps","store","usersState","mapDispatchProps","dispatch"],"mappings":"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","sourcesContent":["import React, {useState, userEffect, useEffect} from 'react'\n\nimport {View, Text, FlatList, Button, TextInput} from 'react-native'\n\nimport firebase from 'firebase/compat'\nrequire('firebase/firestore')\n\nimport {connect} from 'react-redux'\nimport {bindActionCreators} from 'redux'\nimport {fetchUsersData} from '../../redux/actions/index'\n\n function Comment(props) {\n    const [comments, setComments] = useState([])\n    const [postId, setPostId] = useState(\"\")\n    const [text, setText] = useState(\"\")\n\n    useEffect(() => {\n\n        function matchUserToComment(comments){\n\n            for (let i = 0; i < comments.length; i++)\n            {\n                if(comments[i].hasOwnProperty('user'))\n                {\n                    continue;\n                }\n\n\n                const user = props.users.find(x  => x.uid === comments[i].creator)\n                //added an extra comment\n                if (user == undefined)\n                {\n                    props.fetchUsersData(comments[i].creator, false)\n\n                }else {\n                    comments[i].user = user;\n                }\n            }\n\n            setComments(comments);\n\n\n        }\n\n\n        if (props.route.params.postId !== postId)\n        {\n            firebase.firestore()\n                .collection('posts')\n                .doc(props.route.params.uid)\n                .collection('userPosts')\n                .doc(props.route.params.postId)\n                .collection('comments')\n                .get()\n                .then((snapshot) => {\n                    let comments = snapshot.docs.map(doc =>{\n                        const data = doc.data();\n                        const id = doc.id;\n                        return {id, ...data}\n                    })\n                    matchUserToComment(comments)\n                \n            })\n            setPostId(props.route.params.postId)\n        }else {\n            matchUserToComment(comments)\n        }\n\n    }, [props.route.params.postId, props.users])\n\n\nconst onCommentSend = () => {\n    firebase.firestore()\n                .collection('posts')\n                .doc(props.route.params.uid)\n                .collection('userPosts')\n                .doc(props.route.params.postId)\n                .collection('comments')\n                .add({\n                    creator: firebase.auth().currentUser.uid,\n                    text\n                }).then((function () {\n                    props.navigation.popToTop()\n                }))\n\n}\n\n  return (\n    <View>\n        <FlatList\n            numColumns={1}\n            horizontal={false}\n            data={comments}\n            renderItem={({item}) => (\n                <View>\n                    {item.user !== undefined ? \n                    <Text>\n                        {item.user.username}\n                    </Text>\n                : null}\n                    <Text>{item.text}</Text>\n                </View>\n            )}\n        />\n\n        <View>\n            <TextInput\n                placeholder='Comment..'\n                onChangeText={(text) => setText(text)} />\n                <Button\n                    onPress={() => onCommentSend()}\n                    title=\"Send\"\n                    color={'#D2B48C'}\n                />\n        </View>\n\n    </View>\n  )\n}\n\n\nconst mapStateToProps = (store) => ({\n    users: store.usersState.users\n})\nconst mapDispatchProps = (dispatch) => bindActionCreators({ fetchUsersData}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchProps)(Comment);"]},"metadata":{},"sourceType":"module"}